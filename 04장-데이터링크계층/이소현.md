# 학습 목표

- 이더넷을 이해하기
- CSMA/CD 방식 이해하기
- MAC 주소 이해하기
- 스위치 이해하기
- 충돌 도메인 이해하기
- 이더넷 표준 이해하기

# 12 데이터 링크 계층의 역할과 이더넷

- 랜에서는 데이터를 주고 받는 규칙으로 이더넷을 사용
- 랜에서 데이터를 주고받으려면?
    - 2계층(데이터 링크 계층) 기술이 필요함
- 데이터 링크 계층
    - 네트워크 장비 간에 신호를 주고 받는 규칙을 정하는 계층
    - 랜에서 데이터를 정상적으로 주고받기 위해 필요한 계층

### → 가장 많이 사용되는 규칙이 이더넷

- 이더넷은 서브와 같은 장비에 연결된 컴퓨터와 데이터를 주고받을 때 사용
- 컴퓨터 1 → 컴퓨터 2로 데이터를 보낼 때, 목적지 뿐 아니라 허브에 연결된 컴퓨터에 모두 데이터를 보내지만, 못보게 하는 규칙이 정해져있음
    - 보내려는 데이터에 목적지 정보를 추가해서 보내고 목적지 이외의 컴퓨터는 데이터를 받더라도 무시하게 되어있음
- 충돌: 허브로 들어온 데이터는 그대로 모든 포트에 보냄 → 동시에 데이터를 보내면 데이터들이 서로 부딪힐 수 있음

### 이더넷 구조

- 여러 컴퓨터가 동시에 데이터를 전송해도 충돌이 일어나지 않는 구조로 되어있음
    - 데이터가 동시에 케이블을 지나가면 충돌함 → 데이터를 보내는 시점을 늦춤
- CSMA/CD: 이더넷에서 시점을 늦추는 방법
    - CS: 데이터를 보내려고 하는 컴퓨터가 케이블에 신호가 흐르고 있는지 아닌지를 확인한다
    - MA: 케이블에 데이터가 흐르고 있지 않다면 데이터를 보내도 좋다
    - CD: 충돌이 발생하고 있는지를 확인한다
- **요즘에는 효율이 좋지 않아서 CSMA/CD를 거의 사용하지 않음**

→ 스위치 사용함

# 13 MAC 주소의 구조

- 랜카드에는 MAC 주소가 정해져있음
- MAC 주소
    - 물리주소(제조할 때 새겨져서 안바뀜)
    - 전 세계에서 유일한 번호
    - 48비트 → 24비트(랜 카드 제조사 번호) + 24비트(제조사가 랜 카드에 붙인 일련번호)
- 데이터 링크 계층(OSI 모델 기준) 혹은 네트워크 계층(TCP/IP 모델 기준)에 해당하는 데에서 이더넷 헤더와 트레일러를 붙임
- 이더넷 헤더: 목적지 MAC 주소(6 바이트) + 출발지 MAC 주소(6 바이트) + 유형(2 바이트)
    - 유형이란? 이더넷으로 전송되는 상위 계층 프로토콜의 종류 번호
- 프로토콜을 식별하는 유형 번호(16진수) → 외울 필요는 없음
    
    
    | 유형 번호 | 프로토콜 |
    | --- | --- |
    | 0800 | IPv4 |
    | 0806 | ARP |
    | 8035 | RARP |
    | 814C | SNMP over Ethernet |
    | 86DD | IPv6 |
- 트레일러(=FCS): 데이터 전송 도중에 오류가 발생하는지 확인하는 용도로 사용
    - 데이터 뒤에 붙임
- 프레임: 이더넷 헤더와 트레일러가 추가된 데이터
- 네트워크를 통해 프레임(이더넷 헤더+트레일러+데이터)이 전송되는거임

- 예시1: 컴퓨터 1 → 컴퓨터 3으로 전송할 때
    1. 이더넷 헤더에 데이터의 목적지&&자신의 MC 주소 정보를 넣고 데이터를 캡슐화해서 전송함
    2. 물리 계층에서 프레임 비트열을 전기 신호로 변환하여 네트워크를 통해 전송함
    3. 허브가 컴퓨터 1이 보낸 데이터를 1번 포트로 수신하고 2~5번 포트로 전송함
    4. 2,4,5는 목적지 주소가 자신의 MAC 주소와 다르기 때문에 데이터를 파기함
        1. 3만 데이터 수신함
    5. 컴퓨터 3에서 역캡슐화가 일어남 → 물리 계층에서 전기 신호로 전송된 데이터를 비트열로 변환하고 데이터 링크 계층에서 이더넷 헤더와 트레일러를 분리함
- 예시2: 1과2가 동시에 3에게 데이터를 전송하는 경우
    - CSMA/CD방식 사용 → 충돌을 감지한 컴퓨터 2가 잠시 대기하고 데이터를 다시 전송함

# 14 스위치의 구조

- 허브와 스위치의 차이점: 스위치는 데이터 충돌이 발생하지 않음

## 01 MAC 주소 테이블이란?

- 스위치
    - 데이터 링크 계층에서 동작
    - 스위치 == 레이어 2스위치 == 스위칭 허브
    - 내부에 MAC 주소 테이블이 존재
- MAC 주소 테이블(==브릿지 테이블)
    - 스위치의 포트 번호와 해당 포트에 연결되어 있는 컴퓨터의 MAC 주소가 등록되는 데이터베이스
- 최초 전원 켰을 때는 MAC 주소 테이블에 아무것도 등록되어 있지 않음
    - MAC 주소 학습 기능을 통해 주소 등록
        - 컴퓨터에서 목적지 MAC 주소가 추가된 프레임이라는 데이터가 전송되면 MAC 주소 테이블을 확인
        - 출발지 MAC 주소가 등록되어 있지 않으면 MAC 주소와 포트를 같이 등록함

### 플러딩이란?

- 최초로 컴퓨터 1 → 컴퓨터 3으로 전송한 시점에는 컴퓨터 3의 목적지 MAC 주소가 MAC 주소 테이블에 등록되어있지 않음

→ 2~5 포트에 전부 데이터를 전송하게 됨

### 만약 데이터가 등록되어 있다면?

- 컴퓨터 3에만 전송됨

**→ 즉, MAC 주소 필터링이 됨**

- MAC 주소가 등록되어 있으면, 목적지 컴퓨터에만 데이터가 전송됨

# 15 데이터가 케이블에서 충돌하지 않는 구조

## 01 전이중 통신과 반이중 통신

- 전이중 통신: 데이터의 송수신을 동시에 통신하는 방식
- 반이중 통신: 회선 하나로 송신과 수신을 번갈아가면서 통신하는 방식
- 전이중 통신과 반이중 통신 차이점
    - 데이터 동시 전송신
        - 전이중 통신: 충돌 발생X
        - 반이중 통신: 충돌 발생O
- 예시
    - 전이중 통신: 컴퓨터 1과 컴퓨터 2를 직접 **랜케이블로 연결** → 선을 네 쌍 사용하기 때문에 데이터를 동시에 전송해도 문제 없음
        
        ![image.png](attachment:590dfa2b-bab3-4521-a4fa-cd394341deb0:image.png)
        
        - 스위치: 충돌이 일어나지 않는 구조 → 전이중 통신 가능
    - 반이중 통신: 컴퓨터 1과 컴퓨터2를 **허브(더미 허브)로 연결** → 데이터를 보낼 때 충돌이 일어남
        - 충돌이 일어나는 이유는? 허브 내부에는 송수신이 나눠져 있지 않기 때문
        - 송신과 수신이 번갈아가면서 사용하는 방식 이용
    
    ![image.png](attachment:b2f1e13a-e059-4164-a212-603525dd70d8:image.png)
    
- 충돌이 생기면 네트워크 지연이 발생함 → 네트워크로 스위치를 사용하는 것이 표준이됨

### 스위치를 사용하면 이점

- 효율이 좋음
    - 전송하면서 동시에 수신도 가능해서
    - =허브는 반이중 통신 방식을 사용하는 반면, 스위치는 전이중 통신 방식을 사용하기 때문

## 02 충돌 도메인이란?

- 충돌 도메인: 충돌이 발생할 때 그 영향이 미치는 범위
- 충돌 도메인 범위가 넓을수록 지연이 많이됨
- 허브와 스위치의 충돌 도메인 범위는?
    - 허브: 연결되어있는 컴퓨터 전체가 하나의 충돌 도메인이 되는 것
    - 스위치: 데이터를 동시에 송수시할 수 있는 전이중 통신 방식이기 때문에 충돌이 일어나지 않고 충돌 도메인도 좁음
    
    ![image.png](attachment:8ad52e0a-8112-4690-9c54-c7d18da08e06:image.png)
    

### ARP(Address Resolution Protocol)

- 목적지 컴퓨터의 IP 주소를 이용하여 MAC 주소를 찾기 위한 프로토콜
- ARP 요청 필요한 이유
    - 이더넷 프레임을 전송하려면 목적지 컴퓨터의 MAC 주소를 지정해야함
    
     → 출발지 컴퓨터가 목적지 주소를 모르면 MAC 주소를 알아내야함
    
     **→ MAC 주소를 알아내는 방법: 네트워크에 브로드 캐스트를 하는데 이게 ARP 요청임**
    
- ARP 요청을 보내면?
    - 지정된 IP 주소를 가진 컴퓨터는 MAC 주소를 응답으로 보냄(ARP 응답)
- [ARP 요청 → 응답 과정]을 통해 출발지 컴퓨터는 MAC 주소를 얻고 이더넷 프레임을 만들 수 있음
- ARP 테이블: 출발지 컴퓨터는 MAC 주소를 얻은 후 MAC 주소와 IP 주소의 매핑 정보를 메모리에 보관함
    - 데이터 통신은 자신의 컴퓨터에 보관된 ARP 테이블을 참고하여 전송함
- 그럼 IP주소가 변경되면?
    - MAC 주소도 함께 변경되므로 제대로 통신 불가!
        
        → 해결책: ARP 테이블에서는 보존 기간을 ARP 캐시로 지정하고 일정 시간이 지나면 삭제하고 다시 ARP 요청을 함
        

# 16 이더넷의 종류와 특징

## 01 이더넷 규격

- 규격 이름 예시: 10BASE-T
    - 통신 속도+전송 방식+케이블
    - 10Mbps
    - BASE=BASEBAND 전송방식
        
        cf) BASEBAND: 펄스 신호에 의한 디지털 전송방식
        
    - T: 케이블 종류
    - 전송방식 뒤 숫자와 하이픈+알파벳의 차이
        - **동축케이블이냐 UTP케이블이냐의 차이!**
        - 하이픈 뒤는 케이블 길이나 케이블 종류를 나타냄
        - 동축케이블: 케이블의 최대 길이를 100미터 단위로 표시
            - ex) 10BASE5 → 케이블의 최대 길이가 500미터이므로 5로 표시됨
        - UTP케이블: 케이블 종류를 표시
            - ex) 10BASE-T → UTP 케이블을 의미함