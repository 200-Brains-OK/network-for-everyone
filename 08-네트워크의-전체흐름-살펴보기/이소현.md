# 학습 목표

- OSI 모델의 전체 흐름 이해하기
- 웹에 접속할 때 이루어지는 캡슐화, 역캡슐화 이해하기

# 32 랜 카드에서의 데이터 전달과 처리

## 01 네트워크의 구성

### 이 구성은 몇 개의 네트워크?

![image.png](attachment:16b9db5d-30b9-455b-a956-bd3607201c1e:image.png)

- 3개 → 192.168.1.0/24, 172.16.0.0/16, 192.16.8.10.0/24

![image.png](attachment:05cf2bb7-3d4a-4fe2-bcc2-9eea0f85b9d3:image.png)

## 02 컴퓨터의 데이터가 전기 신호로 변환되는 과정

- OSI 모델의 전체적인 관점으로 데이터가 전달되고 처리되는 과정
- 캡슐화와 역캡슐화 이야기
1. 응용 계층에서부터 캡슐화 시작
    - 웹 브라우저에 URL을 입력하고 엔터키 누르면 캡슐화 시작
        - 3-way 핸드셰이크는 이미 완료되어서 연결이 확립되었다고 가정하고 시작
2. HTTP 프로토콜: 웹 브라우저를 이용하여 웹 서버의 웹사이트에 접속하기 위한 요청을 보낼 때 사용하는 것
    - 응용 계층에서는 웹 서버에 이있는 html 데이터를 얻어야하기 때문에 GET 요청을 보냄
3. 데이터가 전송 계층에 전달됨
    - 전송 계층에서 TCP 헤더가 붙어서 **세그먼트**가 됨
4. 데이터가 네트워크 계층에 전달됨
    - 네트워크 계층에서 세그먼트에 IP 헤더가 붙어서(출발지 IP 주소와 목적지 IP 주소를 추가) **IP 패킷**이 됨
5. 데이터가 데이터 링크 계층에 전달됨
    - 데이터 링크 계층에서 이더넷 헤더와 트레일러(FCS)가 붙어서 **이더넷 프레임**이 됨
6. 물리 계층에서 전기 신호로 변환되어 네트워크로 전송됨
7. **랜카드**를 사용하여 데이터를 물리계층에서 전기신호로 변환함

# 33 스위치와 라우터에서의 데이터 전달과 처리

## 01 스위치에서의 데이터 전달과 처리

- 스위치는 데이터 링크 계층에서 [데이터를 전기신호로] 변환하여 라우터로 전송시킴

## 02 라우터에서의 데이터 전달과 처리

- 라우터에서의 캡슐화와 역캡슐화
    1. 스위치에서 데이터가 전기 신호로 변환되어 케이블을 통해 흘러가 라우터A에 도착함
    2. 라우터A는 데이터 링크 계층에서 이더넷 프레임의 목적지 MAC 주소와 자신의 MAC 주소를 비교함
        - 주소가 같으면 이더넷 헤더와 트레일러를 분리하는 역캡슐화를 수행함
    3. 네트워크 계층에 전달하고 자신의 라우팅 테이블과 목적지 IP주소를 비교함
    4. 라우터A의 라우팅테이블에서 목적지 IP주소의 경로를 알 수 있으므로 라우팅을 함
        - 현재 출발지 IP 주소를 라우터A의 외부 IP 주소로 변경함
    5. 데이터 링크 계층으로 전달하여 다른 라우터로 보내지도록 이더넷 헤더와 트레일러를 붙임
    6. 물리 계층에서 데이터를 전기 신호로 변환하여 네트워크로 전달함
    7. 데이터는 전기 신호 형태로 라우터 A → 라우터 B로 전달됨
    8. 데이터가 전기 신호로 변환되어 케이블을 통해 라우터 A → 라우터 B에 도착함
    9. 라우터 B는 이더넷 프레임의 목적지 MAC 주소와 자신의 MAC 주소를 비교함
    10. 주소가 같으면 이더넷 헤더와 트레일러를 분리하는 역캡슐화 진행
    11. 네트워크 게층으로 전달되면 자신의 라우팅 테이블과 목적지 IP 주소를 비교함
        - 라우터B도 목적지의 네트워크를 알아야하기 때문
        - 라우팅테이블을 확인하면 목적지 IP 주소의 경로를 알 수 있으므로 라우팅을 할 수 있음
            - 현재 출발지 IP주소를 라우터 B의 내부 IP주소로 변경함
    12. 데이터 링크 계층에 전달하여 스위치에 전달되도록 이더넷 헤더와 트레일러를 붙임
    13. **물리 계층에서 데이터를 전기 신호로 변환하여 네트워크로 전달(캡슐화)**
    14. 전기 신호 형태의 데이터가 라우터 B에서 스위치 B로 전달됨
    15. 데이터 링크 계층에서 처리하고 웹 서버에 데이터를 전기 신호로 전달함

# 34 웹 서버에서의 데이터 전달과 처리

## 01 웹 서버에서의 데이터 전달과 처리

- OSI 모델의 역캡슐화
    1. 데이터가 전기 신호로 웹 서버에 도착
        - 물리 계층 → 데이터 링크 계층 전달(역캡슐화)
    2. 웹 서버는 **데이터 링크 계층**에서 이더넷 프레임의 목적지 MAC 주소와 자신의 MAC 주소를 비교함
        - 주소가 같으면 이더넷 헤더와 트레일러를 분리하고 네트워크 계층에 전달(역캡슐화)
    3. **네트워크 계층**에서는 목적지 IP 주소와 웹 서버의 IP 주소가 같은지 확인함
        - 주소가 같으면 IP 헤더를 분리하고 전송 계층에 전달
    4. **전송 계층**에서는 목적지 포트 번호를 확인하여 어떤 어플리케이션으로 전달해야하는지 판단
        - TCP 헤더를 분리하여 응용 계층에 전달
    5. 드디어 응용 계층에 도착

→ 요청 한 번에 대한 것, 이다음에 컴퓨터로 응답을 보내야함

# 보강: 정적 라우팅과 동적 라우팅

- 정적 라우팅
    - 관리자가 미리 라우팅 테이블에 경로를 수동으로 추가하는 방법
    - → 소규모 네트워크에 이용
    - 목적지까지 경로를 고정하거나 목적지까지의 경로가 하나로 한정되는 경우에 사용
    - 네트워크에 존재하는 모든 목적지 네트워크 정보를 라우터에 알려줘야함
    - 장점
        - 라우팅 정보가 교환되지 않아 대역폭에 대한 부담이 적음
        - 라우팅 정보가 네트워크로 전달되지 않아서 보안 유지하기 좋음
    - 단점
        - 동적으로 반영되지 않으므로 어떤 경로에 장애가 발생해도 다른 경로로 우회할 수 없음
            - 관리자가 설정을 하나하나 변경해야함
- 동적 라우팅
    - 네트워크 변경을 자동으로 감지하여 라우팅 테이블을 업데이트
    - 네트워크 장애가 발생했을 때 라우터끼리 정보를 교환하여 최적의 경로로 전환함
    - 장점
        - 관리자가 정적 라우팅처럼 라우팅 테이블에 경로를 수동으로 추가할 필요 없음
    - 대규모 네트워크에서 사용